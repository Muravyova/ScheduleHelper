@model ScheduleHelper.Models.ViewModels.ScheduleViewModel

@{
    ViewData["Title"] = "Расписание";
    DateTime? filter = null;
}

<p>
    <br />
    <a asp-action="Create">Добавить</a>

    <div class="form-group">
        <label class="control-label">Выберите дату для фильтрации:</label>
        <input asp-for="@filter" type="date" class="form-control" />
        <a asp-action="Index" asp-route-start="@filter">Фильтровать</a>
    </div>
</p>

<table class="table">
    <thead>
        <tr>
            <th>Время</th>
            <th>Пн</th>
            <th>Вт</th>
            <th>Ср</th>
            <th>Чт</th>
            <th>Пт</th>
            <th>Сб</th>
            <th>Вс</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td id="time_td">
                @for (int i = 0; i < 16; i++)
                {
                    <p id="time">@(7 + i):00</p>
                }
            </td>
                @foreach (var day in Model.Days)
                {
                 <td>
                     @foreach (var time in day.Times)
                     {
                         @foreach (var item in time.Items)
                         {
                             <div class="shedule-obj">
                                 <div class="hidden time">@Html.DisplayFor(modelItem => item.StartTime)</div>
                                 <div class="hidden dur">@Html.DisplayFor(modelItem => item.Duration)</div>
                                 <div class="hidden type">@Html.DisplayFor(modelItem => item.Type)</div>
                                 <div class="timeDur">@Html.DisplayFor(modelItem => item.StartTime) (@Html.DisplayFor(modelItem => item.Duration) минут)</div>
                                 <a asp-action="Details" asp-route-id="@item.Id" asp-route-cw="@Model.CurrentWeek">
                                     <div class="name">@Html.DisplayFor(modelItem => item.Title) (@Html.DisplayFor(modelItem => item.Language.Name))</div>
                                 </a>
                                 <div class="place">
                                     <div style="display: inline-block; float: left;">@Html.DisplayFor(modelItem => item.Teacher.Name)</div>
                                     <div style="display: inline-block; float: right;">@Html.DisplayFor(modelItem => item.Place.Type)</div>
                                 </div>
                             </div>
                         }

                     }
                 </td>   
                }
        </tr>
    </tbody>
</table>

@foreach (var day in Model.Days)
{
    <h2>@Html.DisplayFor(model => day.DayName)</h2>
    @if (day.Times.Count == 0)
    {
        <h3>Нет занятий</h3>
    }
    else
    {
        @foreach (var time in day.Times)
        {
            <h2>@Html.DisplayFor(modelItem => time.StartTime)</h2>

            <table class="table">
                <tbody>
                    @foreach (var scheduleItem in time.Items)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => scheduleItem.Title)
                            </td>
                            <td>
                                @if (scheduleItem.Duration == 60)
                                {
                                    @Html.Display("1 час")
                                }
                                else
                                {
                                    @Html.Display("1,5 часа")
                                }
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => scheduleItem.Type)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => scheduleItem.Language.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => scheduleItem.Place.Type)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => scheduleItem.Teacher.Name)
                            </td>
                            <td>
                                <a asp-action="Details" asp-route-id="@scheduleItem.Id" asp-route-cw="@Model.CurrentWeek">Детали</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    }
}